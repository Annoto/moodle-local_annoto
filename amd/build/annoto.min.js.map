{"version":3,"file":"annoto.min.js","sources":["../src/annoto.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * javscript for component 'local_annoto'.\n *\n * @package\n * @copyright  Annoto Ltd.\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n  'jquery',\n  'core/log',\n  'core/notification',\n  'core/ajax',\n  'core/str',\n  'https://player.vimeo.com/api/player.js',\n  'media_videojs/video-lazy',\n], function($, log, notification, Ajax, tr, VimeoPlayer, videojs) {\n\n    const moodleAnnotoExports = {\n        $,\n        log,\n        notification,\n        Ajax,\n        tr,\n        VimeoPlayer,\n        videojs,\n        require,\n    };\n    window.moodleAnnoto = window.moodleAnnoto ? Object.assign(window.moodleAnnoto, moodleAnnotoExports) : moodleAnnotoExports;\n\n    try {\n        if (window.sessionStorage.getItem('moodleAnnotoDebug')) {\n            log = console;\n        }\n    } catch (err) {}\n\n    return {\n        init: function(courseid, modid) {\n\n            log.info('AnnotoMoodle: starting plugin init');\n            Ajax.call([{\n                methodname: 'get_jsparams',\n                args: {\n                    courseid: courseid,\n                    modid: modid\n                },\n                done: function(response) {\n                    if (!response.result) {\n                        log.warn('AnnotoMoodle: action not permitted for user');\n                        return;\n                    }\n                    const params = JSON.parse(response.params);\n                    window.moodleAnnoto.params = params;\n\n                    const annotoMoodleCdnUrl = params.annotoMoodleCdnUrl ||\n                        'https://cdn.annoto.net/moodle-local-js/latest/annoto.js';\n                    require([annotoMoodleCdnUrl], function(AnnotoMoodle) {\n                        window.AnnotoMoodle = window.AnnotoMoodle || AnnotoMoodle;\n                        AnnotoMoodle.setup();\n                    });\n                },\n                fail: notification.exception,\n            }]);\n        },\n    };\n});\n"],"names":["define","$","log","notification","Ajax","tr","VimeoPlayer","videojs","moodleAnnotoExports","require","window","moodleAnnoto","Object","assign","sessionStorage","getItem","console","err","init","courseid","modid","info","call","methodname","args","done","response","result","warn","params","JSON","parse","annotoMoodleCdnUrl","AnnotoMoodle","setup","fail","exception"],"mappings":";;;;;;;AAuBAA,6BAAO,CACL,SACA,WACA,oBACA,YACA,WACA,yCACA,6BACC,SAASC,EAAGC,IAAKC,aAAcC,KAAMC,GAAIC,YAAaC,eAE/CC,oBAAsB,CACxBP,EAAAA,EACAC,IAAAA,IACAC,aAAAA,aACAC,KAAAA,KACAC,GAAAA,GACAC,YAAAA,YACAC,QAAAA,QACAE,QAAAA,SAEJC,OAAOC,aAAeD,OAAOC,aAAeC,OAAOC,OAAOH,OAAOC,aAAcH,qBAAuBA,wBAG9FE,OAAOI,eAAeC,QAAQ,uBAC9Bb,IAAMc,SAEZ,MAAOC,YAEF,CACHC,KAAM,SAASC,SAAUC,OAErBlB,IAAImB,KAAK,sCACTjB,KAAKkB,KAAK,CAAC,CACPC,WAAY,eACZC,KAAM,CACFL,SAAUA,SACVC,MAAOA,OAEXK,KAAM,SAASC,cACNA,SAASC,mBACVzB,IAAI0B,KAAK,qDAGPC,OAASC,KAAKC,MAAML,SAASG,QACnCnB,OAAOC,aAAakB,OAASA,aAEvBG,mBAAqBH,OAAOG,oBAC9B,0DACJvB,QAAQ,CAACuB,qBAAqB,SAASC,cACnCvB,OAAOuB,aAAevB,OAAOuB,cAAgBA,aAC7CA,aAAaC,YAGrBC,KAAMhC,aAAaiC"}